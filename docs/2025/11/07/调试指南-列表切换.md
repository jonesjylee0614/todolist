# 调试指南 - 列表切换问题

**创建时间**: 2025-11-07  
**目的**: 诊断为什么列表切换时没有加载数据

---

## 📋 已添加的调试日志

### 1. App.vue
```javascript
console.log('=== App.vue loaded ===');           // 应用加载时
console.log('=== App.vue mounted ===');          // 应用挂载时
console.log('Loading all tasks...');              // 加载所有任务
console.log('=== Route changed ===', ...);       // 路由变化时
```

### 2. NowView.vue / FutureView.vue / HistoryView.vue
```javascript
console.log('NowView.vue loaded');                // 组件加载时
console.log('=== NowView mounted ===');           // 组件挂载时
```

### 3. TaskBoard.vue
```javascript
console.log('=== TaskBoard onMounted ===', props.active);  // 组件挂载时
console.log('Loading tasks for status:', props.active);    // 加载任务
```

---

## 🧪 测试步骤

### 步骤 1: 启动开发服务器

```bash
cd frontend
npm run dev
```

### 步骤 2: 打开浏览器

1. 访问 `http://localhost:5173`
2. 按 F12 打开开发者工具
3. 切换到 Console 标签
4. **清空控制台**（点击禁止图标或按 Ctrl+L）

### 步骤 3: 测试并观察日志

1. **首次加载**，应该看到：
   ```
   === App.vue loaded ===
   === App.vue mounted ===
   Loading all tasks...
   NowView.vue loaded          (或其他 View，取决于默认路由)
   === NowView mounted ===
   === TaskBoard onMounted === now
   Loading tasks for status: now
   ```

2. **点击"未来"标签**，应该看到：
   ```
   === Route changed === now -> future
   FutureView.vue loaded
   === FutureView mounted ===
   === TaskBoard onMounted === future
   Loading tasks for status: future
   ```

3. **点击"历史"标签**，应该看到：
   ```
   === Route changed === future -> history
   HistoryView.vue loaded
   === HistoryView mounted ===
   === TaskBoard onMounted === history
   Loading tasks for status: history
   ```

---

## 🔍 可能的问题和排查

### 情况 1: 完全没有日志

**可能原因**：
- 前端服务器没有启动
- 浏览器没有正确加载页面
- 浏览器缓存问题

**排查步骤**：
1. 检查终端是否显示 `Local:   http://localhost:5173/`
2. 在浏览器地址栏确认 URL 是 `http://localhost:5173`
3. 按 Ctrl+Shift+R 强制刷新（清除缓存）
4. 尝试无痕模式打开

### 情况 2: 只有 App.vue 日志，没有 View 日志

**可能原因**：
- 路由配置问题
- View 组件没有被正确加载

**排查步骤**：
1. 检查 Network 标签，看是否有 404 错误
2. 检查 `frontend/src/router/index.ts` 配置
3. 检查 `frontend/src/modules/tasks/pages/` 目录下的文件是否存在

### 情况 3: 有 View 日志，但没有 TaskBoard 日志

**可能原因**：
- TaskBoard 组件没有被渲染
- TaskBoard 导入路径错误

**排查步骤**：
1. 检查 Console 是否有错误信息
2. 检查 Vue DevTools，查看组件树
3. 查看 `frontend/src/modules/tasks/components/TaskBoard.vue` 是否存在

### 情况 4: 首次有日志，切换路由后没有日志

**可能原因**：
- 路由切换没有触发
- 组件被缓存（`<keep-alive>`）

**排查步骤**：
1. 检查 "=== Route changed ===" 日志是否出现
2. 如果路由没有变化，检查 RouterLink 是否正确配置
3. 检查 App.vue 中的 `<RouterView>` 是否有 `<keep-alive>` 包裹

### 情况 5: 有所有日志，但列表不显示

**可能原因**：
- API 请求失败
- 数据格式问题
- 渲染逻辑问题

**排查步骤**：
1. 切换到 Network 标签，查看 `/api/tasks?status=xxx` 请求
2. 检查响应数据是否正确
3. 在 Vue DevTools 中检查 store 数据
4. 检查 TaskColumn 和 TaskCard 组件

---

## 📊 预期的完整日志流程

### 完整的用户操作流程

1. **打开应用**
```
=== App.vue loaded ===
NowView.vue loaded
=== App.vue mounted ===
Loading all tasks...
=== NowView mounted ===
=== TaskBoard onMounted === now
Loading tasks for status: now
```

2. **点击"未来"**
```
=== Route changed === now -> future
FutureView.vue loaded
=== FutureView mounted ===
=== TaskBoard onMounted === future
Loading tasks for status: future
```

3. **点击"历史"**
```
=== Route changed === future -> history
HistoryView.vue loaded
=== HistoryView mounted ===
=== TaskBoard onMounted === history
Loading tasks for status: history
```

4. **再点击"现在"**
```
=== Route changed === history -> now
NowView.vue loaded
=== NowView mounted ===
=== TaskBoard onMounted === now
Loading tasks for status: now
```

---

## 🔧 检查清单

在向我反馈之前，请确认：

- [ ] 开发服务器已启动（控制台显示 Vite 运行）
- [ ] 浏览器已打开正确的 URL（http://localhost:5173）
- [ ] 开发者工具的 Console 标签已打开
- [ ] 已尝试 Ctrl+Shift+R 强制刷新
- [ ] 控制台没有红色错误信息

---

## 📝 反馈模板

请将以下信息提供给我：

1. **控制台日志截图** 或 **完整的日志文本**

2. **操作步骤**：
   - 我打开了应用
   - 我点击了xxx标签
   - 我看到了xxx

3. **Network 标签**：
   - 是否有 API 请求？
   - 请求的 URL 是什么？
   - 响应状态码是什么？

4. **Vue DevTools（如果安装）**：
   - 组件树中是否有 TaskBoard？
   - tasksStore 中是否有数据？

---

## 🎯 下一步

根据你提供的日志，我将能够：
1. 确定问题发生在哪个环节
2. 找出根本原因
3. 提供针对性的修复方案

请按照上述步骤测试，并将结果反馈给我！

